# FIVESTAR GP 2025 Evaluation Tool
5StarGrandPrixEvaluationTool

## 概要
5STAR GP 2025の対戦表管理システムです。試合結果の入力・管理、確定データの配布、個人予想のアップロード機能を提供します。
今年の開催は完了しました。
同様のリーグ戦でまた利用したいと思います。ご利用ありがとうございました。

## 機能

### 基本機能
- **4ブロック対戦表**: Red Stars A/B, Blue Stars A/Bの全対戦表示
- **試合結果入力**: セルクリックで勝敗切り替え（○勝利、△引分、×敗北、空白未定）
- **表示切替**: 全表示/タブ表示の切り替え可能
- **個人スケジュール**: 選手名クリックで個別対戦予定をモーダル表示
- **勝点計算**: 自動集計（勝利2点、引分1点、敗北0点）
- **レスポンシブデザイン**: モバイル対応

### 確定データ管理機能
- **確定データ読み込み**: ページ読み込み時にresult.jsonから自動取得
- **グレー表示**: 確定済み結果は背景グレー、変更不可
- **確定データダウンロード**: 現在の結果をresult.json形式でエクスポート
- **データマージ**: 予想アップロード時に確定データと自動統合（確定データ優先）
- **整合性保持**: 確定済み結果は上書き不可

### データ管理機能
- **結果エクスポート**: 現在の予想をJSONファイルでダウンロード
- **結果インポート**: JSONファイルから予想データを読み込み
- **自動マージ**: 確定データと予想データの自動統合

## ローカル開発環境

### 必要な環境
- Node.js（推奨: v14以上）

### セットアップ手順

1. **依存関係のインストール**
```bash
npm install
```

2. **開発サーバーの起動**
```bash
# 方法1: 自作サーバー（推奨）
npm start
# または
npm run dev

# 方法2: http-server使用
npm run serve
```

3. **ブラウザでアクセス**
```
http://localhost:8000
```

### 使用方法

#### 管理者向け（結果確定）
1. **結果入力**: 対戦セルをクリックして試合結果を入力
   - 1回クリック: ○勝利
   - 2回クリック: △引分 
   - 3回クリック: ×敗北
   - 4回クリック: 空白（未定）
2. **確定データ作成**: 「確定データをダウンロード」ボタンでresult.jsonをダウンロード
3. **配布**: result.jsonをGitHubリポジトリにコミット・プッシュ

#### 一般ユーザー向け（予想入力）
1. **確定データ読み込み**: ページを開くと自動でresult.jsonから確定済み結果を読み込み
2. **視覚的区別**: 確定済み結果はグレー背景で表示、クリック無効
3. **予想入力**: 確定されていない試合のみ予想可能（通常の背景色）
4. **スケジュール確認**: 選手名をクリックで個人対戦スケジュールを表示
5. **データ管理**:
   - 「結果をダウンロード」: 現在の予想をmatch-results.jsonで保存
   - 「結果をアップロード」: 予想ファイルを読み込み（確定データと自動マージ）

#### データの流れ
```
管理者: 結果入力 → 確定データダウンロード → GitHub更新
          ↓
一般ユーザー: ページ開く → 確定データ自動読み込み → 予想入力 → 個人データ保存
```

## ファイル構成
```
/src/
├── index.html          # メインアプリケーション
├── result.json         # 確定済み結果データ
├── package.json        # Node.js設定
├── server.js           # 開発用HTTPサーバー
└── README.md          # このファイル
```

## データ形式

### result.json（確定データ）
```json
{
  "confirmed": {
    "red-a-選手1-選手2": "win",
    "red-a-選手2-選手1": "lose"
  },
  "version": "1.0",
  "lastUpdate": "2025-07-25T12:00:00.000Z",
  "totalMatches": 2
}
```

### match-results.json（個人予想）
```json
{
  "red-a-選手1-選手2": "win",
  "red-a-選手2-選手1": "lose"
}
```

## 技術仕様

### データキー形式
試合結果は以下の形式でキー管理されます：
```
${block}-${player1}-${player2}
例: "red-a-上谷沙弥-羽南"
```

### ファイル形式
- **確定データ**: UTF-8、JSON形式、改行コード LF
- **個人予想**: UTF-8、JSON形式、改行コード LF

### ブラウザ対応
- Chrome (推奨)、Firefox、Safari、Edge
- モバイルブラウザ対応

## トラブルシューティング

### fetchエラー（file://プロトコル）
**問題**: ブラウザで直接HTMLを開くとresult.jsonの読み込みに失敗
```
GET file:///C:/path/result.json net::ERR_FAILED
```
**解決**: 必ずHTTPサーバー経由でアクセス
```bash
npm start
# http://localhost:8000 でアクセス
```

### ポート競合エラー
**問題**: `Error: listen EADDRINUSE :::8000`
**解決**: 別のポートを使用
```bash
PORT=3000 npm start
```

### 確定データが反映されない
**原因**: result.jsonの形式エラーまたはCORS制限
**確認**: 
1. result.jsonの形式が正しいか
2. HTTPサーバー経由でアクセスしているか
3. ブラウザのコンソールでエラーメッセージを確認

### モーダルに確定データが表示されない
**解決済み**: v1.1で修正済み。選手名クリック時のスケジュール表示で確定データも含めて表示されます。

## 本番環境

### 推奨構成
- **静的ホスティング**: GitHub Pages、Netlify、Vercel
- **ファイル配置**: index.htmlとresult.jsonを同一ディレクトリに配置
- **HTTPS必須**: 本番環境ではHTTPS推奨

### GitHub Pages設定例
1. リポジトリのSettingsでPages機能を有効化
2. Source: "Deploy from a branch"
3. Branch: main / root
4. result.jsonを更新後、自動デプロイ